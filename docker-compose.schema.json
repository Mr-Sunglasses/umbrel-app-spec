{
    "$schema": "https://json-schema.org/draft-07/schema",
    "title": "Umbrel Docker Compose Configuration",
    "markdownDescription": "Docker Compose configuration for Umbrel apps. This schema provides helpful information and autocomplete for Umbrel-specific features without strict validation. All standard Docker Compose properties are supported.",
    "type": "object",
    "properties": {
        "version": {
            "title": "Docker Compose Version",
            "markdownDescription": "‚ö†Ô∏è **Umbrel requires exactly version 3.7**\n\nThis is the only supported Docker Compose version for Umbrel apps.",
            "type": "string",
            "default": "3.7",
            "examples": [
                "3.7"
            ]
        },
        "services": {
            "title": "Services",
            "markdownDescription": "**üê≥ Docker Compose Services** - Define your app's containers here.\n\n---\n\n## üîê Special Service: `app_proxy`\n\n**What is it?**\nThe Umbrel App Proxy is a special service that automatically protects your app by requiring users to enter their Umbrel password before accessing it.\n\n**How it works:**\n- Users authenticate when logging into the Web UI or visiting your app directly (e.g., `http://umbrel.local:3002`)\n- Acts as a reverse proxy in front of your app\n- Handles authentication, SSL/TLS, and routing automatically\n\n**Required Configuration:**\n```yaml\napp_proxy:\n  environment:\n    APP_HOST: myapp_web_1        # DNS name of your web container\n    APP_PORT: \"80\"               # Port your app listens on\n```\n\n---\n\n### üö´ Disabling Authentication\n\nSome apps have their own authentication system and don't need Umbrel's login.\n\n**To disable authentication** (while keeping the proxy active for routing):\n```yaml\napp_proxy:\n  environment:\n    APP_HOST: myapp_web_1\n    APP_PORT: \"80\"\n    PROXY_AUTH_ADD: \"false\"      # Disables Umbrel login requirement\n```\n\n‚ö†Ô∏è **Important:** This only disables authentication, not the proxy service itself. The proxy still handles routing and is required unless using `host` network mode.\n\n---\n\n### üéØ Selective Authentication (Whitelist/Blacklist)\n\n**Use Case 1: Public UI + Protected API**\n\nIf your app has a public interface at `/` but an admin API at `/api` that needs protection:\n\n```yaml\napp_proxy:\n  environment:\n    APP_HOST: myapp_web_1\n    APP_PORT: \"80\"\n    PROXY_AUTH_WHITELIST: \"/api/*\"  # Bypasses auth for API calls\n```\n\nResult:\n- `/` ‚Üí Requires Umbrel password ‚úÖ\n- `/api/*` ‚Üí No Umbrel password (use your app's API tokens) ‚ö°\n\n**Use Case 2: Public Root + Protected Admin**\n\nIf you want the root (`/`) publicly accessible but admin section protected:\n\n```yaml\napp_proxy:\n  environment:\n    APP_HOST: myapp_web_1\n    APP_PORT: \"80\"\n    PROXY_AUTH_WHITELIST: \"*\"        # Bypass auth for everything\n    PROXY_AUTH_BLACKLIST: \"/admin/*\" # Except admin section\n```\n\nResult:\n- `/` ‚Üí Public access (no password) üåê\n- `/admin/*` ‚Üí Requires Umbrel password üîí\n\n**Use Case 3: Public Access + Protected Settings**\n\nMultiple protected paths:\n\n```yaml\napp_proxy:\n  environment:\n    APP_HOST: myapp_web_1\n    APP_PORT: \"80\"\n    PROXY_AUTH_WHITELIST: \"*\"\n    PROXY_AUTH_BLACKLIST: \"/admin/*,/settings/*,/config/*\"\n```\n\n---\n\n### üìù Path Pattern Syntax\n\n- `\"/api/*\"` - Matches `/api/` and everything under it\n- `\"/public/*,/health\"` - Comma-separated for multiple paths\n- `\"*\"` - Matches everything (use carefully!)\n- Blacklist overrides whitelist when both are set\n\n---\n\n### üîç Common Examples\n\n**Example 1: Simple Protected App**\n```yaml\nservices:\n  web:\n    image: myapp:latest\n    volumes:\n      - ${APP_DATA_DIR}/data:/data\n  \n  app_proxy:\n    environment:\n      APP_HOST: myapp_web_1\n      APP_PORT: \"3000\"\n```\n\n**Example 2: App with Own Auth**\n```yaml\nservices:\n  web:\n    image: myapp:latest\n  \n  app_proxy:\n    environment:\n      APP_HOST: myapp_web_1\n      APP_PORT: \"8080\"\n      PROXY_AUTH_ADD: \"false\"  # App has its own login\n```\n\n**Example 3: Hybrid Authentication**\n```yaml\nservices:\n  web:\n    image: dokuwiki:latest\n  \n  app_proxy:\n    environment:\n      APP_HOST: dokuwiki_web_1\n      APP_PORT: \"80\"\n      PROXY_AUTH_WHITELIST: \"/api/*,/webhooks/*\"\n      # API/webhooks are public, everything else needs Umbrel password\n```\n\n---\n\n### ‚öôÔ∏è Technical Details\n\n**APP_HOST Format:**\n- Pattern: `{image-name}_{service-name}_1`\n- If image is `nginx:alpine` and service is `web` ‚Üí `nginx_web_1`\n- If image is `ghcr.io/user/myapp:v1` and service is `server` ‚Üí `myapp_server_1`\n\n**APP_PORT:**\n- Internal port your container listens on (not the external Umbrel port)\n- Can be string or integer: `\"80\"`, `3000`, `\"8080\"`\n- This is the port inside your container, not the `port:` in umbrel-app.yml\n\n---\n\nüí° **Best Practices:**\n- Use `app_proxy` for all web-accessible apps (unless using `host` network mode)\n- Only disable authentication if your app has robust built-in auth\n- Be cautious with whitelist `\"*\"` - only use with blacklist to protect sensitive paths\n- Test authentication rules thoroughly before submitting\n\n---",
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "properties": {
                    "image": {
                        "title": "Docker Image",
                        "markdownDescription": "**üê≥ Docker Image** - The container image to use for this service.\n\n**Format:** `[registry/]repository[:tag]`\n\n**Image Sources:**\n\n‚Ä¢ **Docker Hub** (default registry):\n  - `nginx:alpine` - Official Nginx image\n  - `postgres:15` - PostgreSQL version 15\n  - `username/myapp:latest` - User repository\n\n‚Ä¢ **GitHub Container Registry:**\n  - `ghcr.io/owner/repo:tag`\n  - Example: `ghcr.io/getumbrel/umbrel-app:v1.0.0`\n\n‚Ä¢ **Other Registries:**\n  - `gcr.io/project/image:tag` - Google Container Registry\n  - `quay.io/org/image:tag` - Red Hat Quay\n\n**Tag Best Practices:**\n\n‚úÖ **Recommended:**\n- Specific versions: `nginx:1.25.3`, `postgres:15.4`\n- Semantic versions: `myapp:v1.2.3`\n- SHA digests: `myapp@sha256:abc123...` (most reproducible)\n\n‚ö†Ô∏è **Avoid:**\n- `latest` tag (can break unexpectedly when image updates)\n- Mutable tags that change over time\n\n**Examples:**\n```yaml\nimage: nginx:1.25.3-alpine              # Specific version\nimage: postgres:15                       # Major version\nimage: ghcr.io/user/app:v1.0.0          # GitHub registry\nimage: redis:7-alpine                    # Alpine variant (smaller)\n```\n\nüí° **For Umbrel apps:** Always pin to specific versions to ensure reproducible builds and prevent unexpected breaks.",
                        "type": "string",
                        "examples": [
                            "nginx:alpine",
                            "postgres:15",
                            "ghcr.io/owner/repo:tag"
                        ]
                    },
                    "restart": {
                        "title": "Restart Policy",
                        "markdownDescription": "‚ö†Ô∏è **Umbrel strongly recommends: `on-failure`**\n\nControls when Docker automatically restarts your container.\n\n**Options:**\n\n‚Ä¢ **`on-failure`** ‚úÖ **RECOMMENDED** - Restart only if container crashes or exits with error\n  - Containers auto-recover from crashes\n  - Won't restart if manually stopped by user\n  - Best for production reliability\n\n‚Ä¢ **`always`** ‚ö†Ô∏è Not recommended - Restart regardless of exit status\n  - Will restart even if user manually stops the app\n  - Can cause issues with Umbrel's app management\n\n‚Ä¢ **`unless-stopped`** ‚ö†Ô∏è Not recommended - Similar to always\n  - Restarts unless explicitly stopped\n  - May interfere with updates and user control\n\n‚Ä¢ **`no`** ‚ùå Avoid - Never restart automatically\n  - Container stays down after any crash\n  - Requires manual intervention to recover\n  - Poor user experience\n\nüí° **Why `on-failure` is best:** It balances reliability (auto-recovery from crashes) with user control (respects manual stops).",
                        "type": "string",
                        "enum": [
                            "no",
                            "always",
                            "on-failure",
                            "unless-stopped"
                        ],
                        "default": "on-failure"
                    },
                    "ports": {
                        "title": "Port Mappings",
                        "markdownDescription": "**üîå Port Configuration** - Expose container ports to the host system.\n\n‚ö†Ô∏è **Important:** Most Umbrel apps should NOT define ports here. Use the `port:` field in `umbrel-app.yml` instead and let Umbrel's `app_proxy` handle routing.\n\n**When to use:**\n- Internal communication between services (don't expose to host)\n- Services that need direct port access (bypassing app_proxy)\n- Database containers accessed by other containers\n\n**Format Options:**\n\n1. **Simple port:** `3000` - Expose container port 3000 to random host port\n2. **Port mapping:** `\"8080:80\"` - Map host port 8080 to container port 80\n3. **Bind to specific IP:** `\"127.0.0.1:5432:5432\"` - Only localhost can access\n4. **UDP protocol:** `\"8125:8125/udp\"` - For UDP traffic\n\n**Examples:**\n```yaml\nports:\n  - \"8080:80\"              # HTTP traffic\n  - \"127.0.0.1:5432:5432\"  # PostgreSQL (localhost only)\n  - \"8125:8125/udp\"        # StatsD UDP\n```\n\nüí° **Best Practice:** For web apps, omit `ports:` and use `app_proxy` service instead. This provides Umbrel authentication and proper routing.",
                        "type": "array",
                        "items": {
                            "type": [
                                "string",
                                "integer"
                            ]
                        },
                        "examples": [
                            [
                                "8080:80"
                            ],
                            [
                                "3000"
                            ],
                            [
                                "127.0.0.1:5432:5432"
                            ]
                        ]
                    },
                    "volumes": {
                        "title": "Volume Mounts",
                        "markdownDescription": "**üìÅ Umbrel Storage Variables** provide persistent data storage for your app.\n\n---\n\n**üîí App-Specific Private Storage:**\n\n‚Ä¢ **`${APP_DATA_DIR}/`** - Your app's private data directory\n  - Unique to your app, not accessible to other apps\n  - Persists across app updates and restarts\n  - Included in Umbrel backups by default\n  - Use case: Store app configuration, databases, user data\n  - Example path: `/home/umbrel/umbrel/app-data/myapp/data`\n  - Usage: `${APP_DATA_DIR}/database:/var/lib/mysql`\n\n---\n\n**üåê Communal Shared Storage:**\n\n‚Ä¢ **`${UMBREL_ROOT}/data/storage/`** - Shared storage accessible across multiple apps\n  - ‚ö†Ô∏è **Requires permission:** Add `STORAGE_DOWNLOADS` to `permissions:` array in umbrel-app.yml\n  - Shared between all apps that have this permission\n  - Use case: Access user's downloads, media library, or shared files\n  - Common subdirectories:\n    - `downloads/` - Downloaded files\n    - `media/` - Photos, videos, music\n    - `documents/` - Shared documents\n  - Example: `${UMBREL_ROOT}/data/storage/downloads:/app/downloads`\n  - Security: Only request this permission if your app genuinely needs shared storage access\n\n---\n\n**‚Çø Bitcoin & Lightning Data** (requires dependencies in umbrel-app.yml):\n\n‚Ä¢ **`${APP_BITCOIN_DATA_DIR}`** - Bitcoin Core blockchain and data\n  - Requires: `dependencies: [\"bitcoin\"]` in umbrel-app.yml\n  - Contains: Blockchain data, wallet, bitcoin.conf\n  - Typically mounted read-only: `:ro`\n  - Use case: Access Bitcoin blockchain for validation or queries\n  - Example: `${APP_BITCOIN_DATA_DIR}:/bitcoin:ro`\n\n‚Ä¢ **`${APP_LIGHTNING_NODE_DATA_DIR}`** - Lightning Network node data\n  - Requires: `dependencies: [\"lightning\"]` in umbrel-app.yml\n  - Contains: LND data, TLS certificates, macaroons for authentication\n  - Typically mounted read-only: `:ro`\n  - Use case: Connect to user's Lightning node programmatically\n  - Example: `${APP_LIGHTNING_NODE_DATA_DIR}:/lnd:ro`\n\n---\n\n**üìù Volume Mount Format:**\n\n**Syntax:** `host_path:container_path[:mode]`\n\n- `host_path` - Path on Umbrel system (use variables like `${APP_DATA_DIR}`)\n- `container_path` - Path inside your container (e.g., `/app/data`)\n- `mode` - Optional access mode:\n  - `rw` - Read-write (default)\n  - `ro` - Read-only (recommended for sensitive data like Bitcoin/Lightning)\n\n**Examples:**\n\n```yaml\nvolumes:\n  # App private storage (read-write)\n  - ${APP_DATA_DIR}/data:/app/data\n  \n  # App config (read-only)\n  - ${APP_DATA_DIR}/config:/etc/myapp:ro\n  \n  # Shared downloads folder (requires STORAGE_DOWNLOADS permission)\n  - ${UMBREL_ROOT}/data/storage/downloads:/downloads:rw\n  \n  # Bitcoin blockchain (read-only, requires bitcoin dependency)\n  - ${APP_BITCOIN_DATA_DIR}:/bitcoin:ro\n  \n  # Lightning node data (read-only, requires lightning dependency)\n  - ${APP_LIGHTNING_NODE_DATA_DIR}:/lnd:ro\n```\n\nüí° **Best Practices:**\n- Always use Umbrel variables instead of hardcoded paths\n- Use read-only (`:ro`) for data you only need to read\n- Request `STORAGE_DOWNLOADS` permission only if genuinely needed\n- Organize your app data into subdirectories for clarity",
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "examples": [
                            [
                                "${APP_DATA_DIR}/data:/app/data"
                            ],
                            [
                                "${APP_DATA_DIR}/config:/etc/app:ro",
                                "${UMBREL_ROOT}/data/storage/downloads:/downloads"
                            ]
                        ]
                    },
                    "environment": {
                        "title": "Environment Variables",
                        "markdownDescription": "**üîß Umbrel Special Variables** are automatically injected by the Umbrel system and available to all containers.\n\n---\n\n**üì± System & Device Information:**\n\n‚Ä¢ **`$DEVICE_HOSTNAME`** - The hostname of the user's Umbrel device (typically \"umbrel\")\n  - Use case: Display the device name in your app's UI or logs\n  - Example value: `umbrel`\n\n‚Ä¢ **`$DEVICE_DOMAIN_NAME`** - The .local mDNS domain of the device\n  - Use case: Generate links to other services on the local network\n  - Example value: `umbrel.local`\n\n---\n\n**üßÖ Tor Network Integration:**\n\n‚Ä¢ **`$TOR_PROXY_IP`** - IP address of Umbrel's Tor SOCKS5 proxy\n  - Use case: Route your app's traffic through Tor for privacy\n  - Combine with `$TOR_PROXY_PORT` to get full proxy address\n  - Example value: `10.21.0.1`\n\n‚Ä¢ **`$TOR_PROXY_PORT`** - Port number of the Tor SOCKS5 proxy (typically 9050)\n  - Use case: Configure proxy settings like `$TOR_PROXY_IP:$TOR_PROXY_PORT`\n  - Example value: `9050`\n  - Common usage: `TOR_PROXY=$TOR_PROXY_IP:$TOR_PROXY_PORT`\n\n---\n\n**üîê App-Specific Security & Authentication:**\n\n‚Ä¢ **`$APP_PASSWORD`** - Automatically generated random 32-character password\n  - Use case: Default password for your app's admin interface\n  - Displayed in Umbrel UI for users to copy\n  - Regenerated on each app installation\n  - Example value: `mYsUperSeCurErandoMp@ssw0rd123456`\n\n‚Ä¢ **`$APP_SEED`** - Deterministic 256-bit seed unique to this app installation\n  - Use case: Generate consistent cryptographic keys, derive passwords, or create deterministic identifiers\n  - Derived from user's master Umbrel seed using app ID\n  - Same for each app reinstallation (as long as user keeps same Umbrel seed)\n  - Security: Never expose this directly to users or logs\n  - Example value: `a1b2c3d4e5f6...` (64-character hex string)\n\n‚Ä¢ **`$APP_HIDDEN_SERVICE`** - Your app's unique .onion Tor hidden service address\n  - Use case: Display to users for anonymous Tor Browser access\n  - Only accessible via Tor network\n  - Example value: `abcdefghijklmnop.onion`\n\n---\n\n**üåê Bitcoin & Lightning Integration** (only available when dependencies are declared):\n\n‚Ä¢ **`$APP_BITCOIN_DATA_DIR`** - Path to Bitcoin Core data directory\n  - Requires: `dependencies: [\"bitcoin\"]` in umbrel-app.yml\n  - Use case: Access Bitcoin blockchain data and RPC\n  - Example: Mount as read-only volume for blockchain access\n\n‚Ä¢ **`$APP_LIGHTNING_NODE_DATA_DIR`** - Path to Lightning Network node data\n  - Requires: `dependencies: [\"lightning\"]` in umbrel-app.yml\n  - Use case: Access LND node data, TLS certs, and macaroons\n  - Example: Connect to user's Lightning node programmatically\n\n‚Ä¢ **`$APP_BITCOIN_IP`** - Internal IP address of Bitcoin Core container\n  - Use case: Connect to Bitcoin RPC\n\n‚Ä¢ **`$APP_BITCOIN_RPC_PORT`** - Bitcoin Core RPC port (typically 8332)\n  - Use case: Combine with `$APP_BITCOIN_IP` for RPC calls\n\n‚Ä¢ **`$APP_BITCOIN_RPC_USER`** - Bitcoin Core RPC username\n  - Use case: Authenticate RPC calls\n\n‚Ä¢ **`$APP_BITCOIN_RPC_PASS`** - Bitcoin Core RPC password\n  - Use case: Authenticate RPC calls\n\n‚Ä¢ **`$APP_LIGHTNING_NODE_IP`** - Internal IP address of Lightning node\n  - Use case: Connect to LND gRPC or REST API\n\n‚Ä¢ **`$APP_LIGHTNING_NODE_GRPC_PORT`** - LND gRPC port (typically 10009)\n  - Use case: Make gRPC calls to Lightning node\n\n‚Ä¢ **`$APP_LIGHTNING_NODE_REST_PORT`** - LND REST API port (typically 8080)\n  - Use case: Make REST API calls to Lightning node\n\n---\n\n**üîå App Proxy Configuration** (only for `app_proxy` service):\n\nThese variables configure Umbrel's authentication proxy that sits in front of your app:\n\n‚Ä¢ **`APP_HOST`** - DNS name of your web container (required)\n  - Format: `imagename_servicename_1`\n  - Example: If image is `nginx:alpine` and service is `web`, use `nginx_web_1`\n  - This tells the proxy which container to forward requests to\n\n‚Ä¢ **`APP_PORT`** - Internal port your app listens on (required)\n  - The port inside your container (not the external Umbrel port)\n  - Can be string or integer\n  - Example: `3000`, `\"8080\"`, `80`\n\n‚Ä¢ **`PROXY_AUTH_ADD`** - Disable Umbrel authentication (optional)\n  - Set to `\"false\"` to disable login requirement (proxy stays active for routing)\n  - Use case: Apps with their own authentication system\n  - Warning: Only disables auth, does not remove proxy service entirely\n\n‚Ä¢ **`PROXY_AUTH_WHITELIST`** - Bypass auth for specific URL paths (optional)\n  - Comma-separated list of paths that don't require login\n  - Supports wildcards with `*`\n  - Example: `\"/api/*,/public/*,/health\"`\n  - Use case: Allow public API access while protecting admin pages\n\n‚Ä¢ **`PROXY_AUTH_BLACKLIST`** - Force auth for specific URL paths (optional)\n  - Comma-separated list of paths that always require login\n  - Overrides whitelist if both are set\n  - Example: `\"/admin/*,/settings/*\"`\n  - Use case: Protect sensitive sections even if auth is disabled\n\n---\n\nüí° **Tip:** Environment variables can be defined as an object (recommended) or array format. Use object format for better readability.",
                        "oneOf": [
                            {
                                "type": "object",
                                "additionalProperties": true
                            },
                            {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            }
                        ],
                        "examples": [
                            {
                                "APP_HOST": "myapp_web_1",
                                "APP_PORT": "3000",
                                "DEVICE_NAME": "$DEVICE_HOSTNAME",
                                "TOR_PROXY": "$TOR_PROXY_IP:$TOR_PROXY_PORT",
                                "ADMIN_PASSWORD": "$APP_PASSWORD"
                            }
                        ]
                    },
                    "depends_on": {
                        "title": "Service Dependencies",
                        "markdownDescription": "**üîó Service Dependencies** - Define which services must start before this one.\n\n**How it works:**\n- Docker Compose starts dependencies first\n- Only waits for container to start, not for app to be \"ready\"\n- Useful for ensuring databases start before app containers\n\n**Examples:**\n```yaml\ndepends_on:\n  - db              # Start database first\n  - redis           # Then Redis\n  - migrate         # Then run migrations\n```\n\n‚ö†Ô∏è **Important:** `depends_on` doesn't wait for the service to be \"ready\" (e.g., database accepting connections). Your app should implement retry logic or use health checks.\n\nüí° **Common pattern:**\n```yaml\nservices:\n  app:\n    depends_on:\n      - db\n  db:\n    image: postgres:15\n```",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "command": {
                        "title": "Command Override",
                        "markdownDescription": "**‚öôÔ∏è Command Override** - Replace the default command from the Docker image.\n\n**Format Options:**\n\n1. **String format:** `\"npm start\"`\n2. **Array format:** `[\"npm\", \"start\"]` (recommended for complex commands)\n\n**Examples:**\n```yaml\n# String format\ncommand: \"python app.py --debug\"\n\n# Array format (better for arguments with spaces)\ncommand:\n  - python\n  - app.py\n  - --config\n  - /etc/app/config.json\n```\n\nüí° **Tip:** Use array format for commands with multiple arguments or special characters.",
                        "oneOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            }
                        ]
                    },
                    "user": {
                        "title": "User",
                        "markdownDescription": "**üë§ User Context** - Specify which user runs the container process.\n\n**Format Options:**\n- Username: `\"nginx\"`, `\"nobody\"`\n- UID: `\"1000\"`, `\"33\"`\n- UID:GID: `\"1000:1000\"`, `\"33:33\"`\n\n**Why use this:**\n- Security: Run as non-root user\n- Permissions: Match host user for volume access\n- Compliance: Follow security best practices\n\n**Examples:**\n```yaml\nuser: \"1000:1000\"    # Run as user ID 1000\nuser: \"nginx\"        # Run as nginx user\nuser: \"nobody\"       # Run as nobody (minimal permissions)\n```\n\n‚ö†Ô∏è **Important:** If your app writes to volumes, ensure this user has write permissions on mounted directories.\n\nüí° **Best Practice:** Avoid running as root (UID 0) when possible for security.",
                        "type": "string"
                    },
                    "networks": {
                        "title": "Networks",
                        "markdownDescription": "Networks to connect this service to.",
                        "oneOf": [
                            {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            },
                            {
                                "type": "object"
                            }
                        ]
                    },
                    "network_mode": {
                        "title": "Network Mode",
                        "markdownDescription": "**üåê Network Mode** - Advanced network configuration for the container.\n\n**Options:**\n\n‚Ä¢ **`bridge`** (default) - Standard Docker networking\n  - Containers get their own network namespace\n  - Can communicate with other containers via internal network\n  - Recommended for most apps\n\n‚Ä¢ **`host`** - Share host's network stack\n  - Container uses host's IP address directly\n  - No port mapping needed\n  - ‚ö†Ô∏è **Warning:** Cannot use with `app_proxy` service\n  - Use case: Apps that need to bind to specific host interfaces\n\n‚Ä¢ **`none`** - No networking\n  - Container has no network access\n  - Use case: Isolated processing tasks\n\n‚Ä¢ **`service:[name]`** - Share another service's network\n  - Example: `\"service:web\"`\n  - Use case: Sidecar containers\n\n**Examples:**\n```yaml\nnetwork_mode: \"host\"           # Use host networking\nnetwork_mode: \"bridge\"         # Default bridge network\nnetwork_mode: \"service:web\"    # Share web service's network\n```\n\n‚ö†Ô∏è **Important for Umbrel:**\n- Using `host` mode requires **disabling** the `app_proxy` service entirely\n- Most apps should use default `bridge` mode\n- Only use `host` mode if your app specifically requires it\n\nüí° **When to use `host` mode:**\n- Multicast/broadcast requirements\n- Low-level network operations\n- Apps that discover services via network scanning",
                        "type": "string"
                    }
                },
                "additionalProperties": true
            }
        },
        "networks": {
            "title": "Networks",
            "markdownDescription": "Custom networks for inter-service communication.",
            "type": "object",
            "additionalProperties": true
        },
        "volumes": {
            "title": "Named Volumes",
            "markdownDescription": "Named volumes for persistent data storage.",
            "type": "object",
            "additionalProperties": true
        }
    },
    "additionalProperties": true,
    "examples": [
        {
            "title": "Simple Web App",
            "description": "Basic web app with Umbrel app proxy",
            "compose": {
                "version": "3.7",
                "services": {
                    "web": {
                        "image": "nginx:alpine",
                        "volumes": [
                            "${APP_DATA_DIR}/html:/usr/share/nginx/html"
                        ]
                    },
                    "app_proxy": {
                        "environment": {
                            "APP_HOST": "web_1",
                            "APP_PORT": 80
                        }
                    }
                }
            }
        },
        {
            "title": "App with Database and Tor",
            "description": "Multi-service app with database and Tor integration",
            "compose": {
                "version": "3.7",
                "services": {
                    "app": {
                        "image": "myapp:latest",
                        "environment": {
                            "DEVICE_NAME": "$DEVICE_HOSTNAME",
                            "DB_PORT": 3306,
                            "USE_TOR": "true",
                            "TOR_PROXY": "$TOR_PROXY_IP:$TOR_PROXY_PORT",
                            "ADMIN_PASSWORD": "$APP_PASSWORD"
                        },
                        "volumes": [
                            "${APP_DATA_DIR}/data:/app/data",
                            "${UMBREL_ROOT}/data/storage/uploads:/uploads"
                        ],
                        "depends_on": [
                            "db"
                        ]
                    },
                    "db": {
                        "image": "mysql:8",
                        "environment": {
                            "MYSQL_ROOT_PASSWORD": "secret",
                            "MYSQL_DATABASE": "myapp"
                        },
                        "volumes": [
                            "${APP_DATA_DIR}/mysql:/var/lib/mysql"
                        ]
                    },
                    "app_proxy": {
                        "environment": {
                            "APP_HOST": "app_1",
                            "APP_PORT": 3000,
                            "PROXY_AUTH_WHITELIST": "/api/*,/health"
                        }
                    }
                }
            }
        }
    ]
}
